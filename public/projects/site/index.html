<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
    
  <title>Dev Ops are not Optional. | ivy (likethevine)</title><meta name="description" content="We want to automate as much as possible! &lt;a href=&#39;https://www.ta-systems.com/system-categories/automated-assembly-lines/&#39;&gt;Source&lt;/a&gt; Sustainable SoftwareOk, so the title is Software Engineer or Software Developer, but writing code and building software is only part of the solution. The other half (or more) of the job is designing software solutions for humans to interact with. Software only is useful because we humans use it. Without us, the software is just some meaningless electricity in some far away warehouse.">
  <meta name="keywords" content="blog,developer,personal">

  <meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ivylikethevine.com/"/>

<meta name="twitter:title" content="Dev Ops are not Optional."/>
<meta name="twitter:description" content="We want to automate as much as possible! &lt;a href=&#39;https://www.ta-systems.com/system-categories/automated-assembly-lines/&#39;&gt;Source&lt;/a&gt; Sustainable SoftwareOk, so the title is Software Engineer or Software Developer, but writing code and building software is only part of the solution. The other half (or more) of the job is designing software solutions for humans to interact with. Software only is useful because we humans use it. Without us, the software is just some meaningless electricity in some far away warehouse."/>

  <meta property="og:title" content="Dev Ops are not Optional." />
<meta property="og:description" content="We want to automate as much as possible! &lt;a href=&#39;https://www.ta-systems.com/system-categories/automated-assembly-lines/&#39;&gt;Source&lt;/a&gt; Sustainable SoftwareOk, so the title is Software Engineer or Software Developer, but writing code and building software is only part of the solution. The other half (or more) of the job is designing software solutions for humans to interact with. Software only is useful because we humans use it. Without us, the software is just some meaningless electricity in some far away warehouse." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ivylikethevine.com/projects/site/" /><meta property="og:image" content="https://ivylikethevine.com/"/><meta property="article:section" content="projects" />
<meta property="article:published_time" content="2023-10-15T00:00:00+00:00" />
<meta property="article:modified_time" content="2023-10-15T23:28:31-07:00" />

  <link rel="stylesheet" href="/css/bootstrap.min.css"  crossorigin="anonymous">
  
  <link href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.1/css/all.min.css" rel="stylesheet" type="text/css">

  <link rel="stylesheet" href="/sass/main.css">

  <link rel="stylesheet" href="/zoomjs/zoom.min.css">

  <script src=/js/lazysizes.min.js></script>

  
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="shortcut icon" href="/favicon.png" type="image/x-icon">
  <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
  <link rel="icon" href="/logo.svg" sizes="any" type="image/svg+xml" />


</head>



<body ontouchstart="">
  <nav class="navbar navbar-default navbar-custom navbar-fixed-top invert">
  <div class="container-fluid">
    
    <div class="navbar-header page-scroll">
      <button type="button" class="navbar-toggle">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="https://ivylikethevine.com/">ivy (likethevine)</a>
    </div>
    
    <div id="huxblog_navbar">
      <div class="navbar-collapse">
        <ul class="nav navbar-nav navbar-right">
          
          <li><a href="/" title="home">home</a></li>
          
          <li><a href="/resume/" title="resume">resume</a></li>
          

          <li class="search-icon">
            <a href="javascript:void(0)">
              <i class="fa fa-search"></i>
            </a>
          </li>
        </ul>
      </div>
    </div>
    
  </div>
  
</nav>
<script>
  
  
  
  var $body = document.body;
  var $toggle = document.querySelector(".navbar-toggle");
  var $navbar = document.querySelector("#huxblog_navbar");
  var $collapse = document.querySelector(".navbar-collapse");

  var __HuxNav__ = {
    close: function () {
      $navbar.className = " ";
      
      setTimeout(function () {
        
        if ($navbar.className.indexOf("in") < 0) {
          $collapse.style.height = "0px";
        }
      }, 400);
    },
    open: function () {
      $collapse.style.height = "auto";
      $navbar.className += " in";
    },
  };

  
  $toggle.addEventListener("click", function (e) {
    if ($navbar.className.indexOf("in") > 0) {
      __HuxNav__.close();
    } else {
      __HuxNav__.open();
    }
  });

  

  document.addEventListener("click", function (e) {
    if (e.target == $toggle) return;
    if (e.target.className == "icon-bar") return;
    __HuxNav__.close();
  });
</script>
  
<div class="search-page">
  <div class="search-icon-close-container">
    <span class="search-icon-close">
      <i class="fa fa-chevron-down"></i>
    </span>
  </div>
  <div class="search-main container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <form></form>
        <input type="text" id="search-input" placeholder="$ grep...">
        </form>
        <div id="search-results" class="mini-post-list"></div>
      </div>
    </div>
  </div>
</div>

  
  


<style type="text/css">
  header.intro-header {
    position: relative;
    background-image: url('');
  }
</style>

<header class="intro-header style-text">

  <div class="header-mask"></div>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        <div class="post-heading">
          <div class="tags">
            
            <a class="tag" href="/tags/ci/cd/" title="CI/CD">CI/CD</a>
            
            <a class="tag" href="/tags/hugo/" title="hugo">hugo</a>
            
            <a class="tag" href="/tags/cloudflare/" title="Cloudflare">Cloudflare</a>
            
            <a class="tag" href="/tags/github/" title="github">github</a>
            
            <a class="tag" href="/tags/dev-ops/" title="dev ops">dev ops</a>
            
          </div>
          <h1>Dev Ops are not Optional.</h1>
          <h2 class="subheading">Deploying a modern website with SVM/CI/CD.</h2>
          <span class="meta">
            Posted by  Ivy Duggan 
            on Sun, Oct 15, 2023
          </span>
        </div>
      </div>
    </div>
  </div>
</header>


  


<article>
  <div class="container">
    <div class="row">

      
      <div class="
              col-lg-8 col-lg-offset-2
              col-md-10 col-md-offset-1
              post-container">
        <p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/assembly-line_hu081b5fe0e05f32d4808cdd6ffa14a8bb_686749_937x560_resize_q75_h2_box.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/assembly-line.ca34ab4dbaab0010667a9175f9fa94bb.jpg"
    alt="image"
    loading="lazy"
    height="560"
    width="937"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">We want to automate as much as possible! &lt;a href=&#39;https://www.ta-systems.com/system-categories/automated-assembly-lines/&#39;&gt;Source&lt;/a&gt;</figcaption>
    </figure></p>
<h1 id="sustainable-software">Sustainable Software<a class="anchorjs-link" href="#sustainable-software"></a></h1><p>Ok, so the title is Software Engineer or Software Developer, but writing code and building software is only part of the solution. The other half (or more) of the job is <em>designing software solutions for humans to interact with</em>. Software only is useful because <strong>we humans</strong> use it. Without us, the software is just some meaningless electricity in some far away warehouse. UI/UX design is important, but just as critical is <strong>developer operations</strong> (dev ops).</p>
<dl>
<dt>Dev Ops</dt>
<dd>outlines a software development process and an organizational culture shift that speeds the delivery of higher quality software by automating and integrating the efforts of development and IT operations teams â€“ two groups that traditionally practiced separately from each other, or in silos.<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></dd>
</dl>
<h3 id="what-as-dev-ops">What as Dev Ops?<a class="anchorjs-link" href="#what-as-dev-ops"></a></h3><p>Don&rsquo;t get me wrong, large scale production deployments can have very complex dev ops! However, even for a single developer, the tools and systems required are very easy, often free, and can massively improve productivity.</p>
<p>Here is my list of main dev ops goals. Some may seem obvious, but all of these are drawn from experience starting new projects as well as inheriting many projects of dubious quality.</p>
<ul>
<li>Source Version Mangement
<ul>
<li><strong>Rule 1</strong>: software changes need to be easily assigned, tracked, and checked</li>
<li><strong>Rule 2</strong>: environment variables need to be stored safely (important enough to state again)</li>
</ul>
</li>
<li>Deployments
<ul>
<li><strong>Rule 1</strong>: deploying new versions should be automated via CI/CD and require no human intervention</li>
<li><strong>Rule 2</strong>: staging site to test versions before production deployment</li>
</ul>
</li>
<li>Onboarding
<ul>
<li><strong>Rule 1</strong>: new devs need to be able to download and deploy system within a day<sup id="fnref:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup></li>
<li><strong>Rule 2</strong>: new devs should not be able to break production</li>
</ul>
</li>
</ul>
<h2 id="the-fallacy-of-saving-time">The Fallacy of Saving Time<a class="anchorjs-link" href="#the-fallacy-of-saving-time"></a></h2><p>Dev Ops takes time to setup, but it is absolutely worth it. Here&rsquo;s a story from my days as a contractor. At one company, it took 2 developers at least 4 hours each to deploy our application (at a <em>generous</em> minimum). Here&rsquo;s how that math works out over just a single year:</p>

<div class="katex-output">
  $$\(devHours &gt;= 2\dfrac{deployments}{month} *8\dfrac{devHours}{deployment}* 12\dfrac{months}{year} \approxeq 192\)$$
</div>

<p>That&rsquo;s over a month of dev hours lost per year! Does any dev want to waste a month every single year running the same deployments? However, this is just the tip of the iceberg. If your system takes a day to patch, what happens when a major exploit is found in production?</p>
<p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/spongebob-panic_hu5cb0946ae4c4a2b33e576a229e55cc7a_1727168_320x240_resize_q75_h2_box_1.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/spongebob-panic.a793b0e07f5860b304ccc7e3a9a10b1b.gif"
    alt="image"
    loading="lazy"
    height="240"
    width="320"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">This is what happens. I&#39;ve been in the room.</figcaption>
    </figure></p>
<p>This is a single example of poor dev ops, but time is money and similar math applies to dozens of scenarios.</p>
<h3 id="so-lets-do-it-right">So Let&rsquo;s Do It Right<a class="anchorjs-link" href="#so-lets-do-it-right"></a></h3><h4 id="i-source-version-mangement-svmgit">i. Source Version Mangement (svm/git)<a class="anchorjs-link" href="#i-source-version-mangement-svmgit"></a></h4><p>Talking to my college friends, it seems a lot of CS majors do not learn Source Version Management (or SVM). Basically, we want a history of all of our code changes, and the ability to go back to specific checkpoints and fix things that break. There are a few tools for this, but I use <code>git</code> as the SVM and github.com to hold my repositories (as well as provide other dev ops tools, discussed later).</p>
<p><code>git</code> is very powerful and very complex, but we only need a few commands to set up a useable CI/CD environment. This graph is a simple version of &ldquo;git flow&rdquo;, or a semi-standard way to use github branches.</p>
<pre class="mermaid">
gitGraph
    commit
    branch develop
    checkout develop
    branch add-feature
    checkout add-feature
    commit
    commit
    checkout develop
    branch fix-bug
    checkout fix-bug
    commit
    checkout develop
    merge add-feature
    checkout main
    merge develop
    checkout develop
    merge fix-bug
    checkout main
    merge develop
</pre>

<p><code>main</code> (previously defaulted to <code>master</code>): this is our production code. Never work  directly from main. Never interact with main via CLI.</p>
<p><code>development</code>: this is our staging code. This is where we start new branches</p>
<p><code>&lt;named-branch&gt;</code>: these are self contained changes to the project. Here we have <code>add-feature</code> and <code>fix-bug</code>, but often there are different categories of named branches such as <code>feature/featureName</code> or <code>bug/bugName</code>.</p>
<p>This is how we would setup a repository to follow basic git flow.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git config --global init.defaultBranch <span style="color:#f1fa8c">&#34;main&#34;</span> <span style="color:#6272a4"># By default, git may still use `master`, so we set default to `main`.</span>
</span></span><span style="display:flex;"><span><span style="color:#8be9fd;font-style:italic">cd</span> projectFolder
</span></span><span style="display:flex;"><span>git init
</span></span><span style="display:flex;"><span>git push -u origin main <span style="color:#6272a4"># here we setup the remote copy of our repo</span>
</span></span><span style="display:flex;"><span>git checkout -b development <span style="color:#6272a4"># -b is only needed when creating a branch</span>
</span></span><span style="display:flex;"><span>git push
</span></span><span style="display:flex;"><span>git checkout -b featureName
</span></span></code></pre></div><p>Now, we can work on <code>featureName</code> without impacting anything else. Additionally, other devs on our team can branch from <code>development</code> and any merge conflicts will be dealt with on the <code>development</code> branch before merging into <code>main</code>.</p>
<p>Once our feature is added:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#282a36;-moz-tab-size:2;-o-tab-size:2;tab-size:2;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git add . <span style="color:#6272a4"># the &#39;.&#39; convention will add ALL modified files. Only modify files that you need to. git restore fileName will undo any changes.</span>
</span></span><span style="display:flex;"><span>git commit -m <span style="color:#f1fa8c">&#34;Added feature&#34;</span> <span style="color:#6272a4"># -m only allows inline commit messages. A commit is basically a checkpoint we can go back to later.</span>
</span></span><span style="display:flex;"><span>git push
</span></span><span style="display:flex;"><span>git checkout develop
</span></span></code></pre></div><p>Now, we could immediately create a pull request from <code>development</code> into <code>production</code>, but it is preferable to have a staging or development site. A staging site is a live site that usually only devs/testers can access. So let&rsquo;s deploy a staging site!</p>
<h4 id="ii-continuous-integration-and-continuous-deployment-cicd">ii. Continuous Integration and Continuous Deployment (CI/CD)<a class="anchorjs-link" href="#ii-continuous-integration-and-continuous-deployment-cicd"></a></h4><p>My website is made with <a href="https://gohugo.io/" target="_blank">Hugo</a>, a static site generator written in Go. It has a theme called <a href="https://themes.gohugo.io/themes/hugo-theme-puppet/" target="_blank">Puppet</a>, and I have it deployed to a custom domain (ivylikethevine.com) Originally I had used <a href="https://pages.github.com/" target="_blank">Github Pages</a> alongside <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>, but found that the setup for a staging &amp; production environment was tedious.<sup id="fnref:3"><a href="#fn:3" class="footnote-ref" role="doc-noteref">3</a></sup></p>
<p>Eventually, I switched to <a href="https://pages.Cloudflare.com/" target="_blank">Cloudflare Pages</a>, which I recommend as it allows us to access Cloudflare Zero Trust, a system to authenticate users before accessing webpages.<sup id="fnref:4"><a href="#fn:4" class="footnote-ref" role="doc-noteref">4</a></sup> Cloudflare Pages also defaults to creating preview pages, essentially staging sites per branch, and we can configure our staging site to deploy from the <code>development</code> branch when a change is pushed.</p>
<p>Luckily, Cloudflare has a pretty slick Github integration, so we can follow the instructions <a href="https://developers.Cloudflare.com/pages/platform/git-integration" target="_blank">here</a>. Note: only allow the minimum required permissions for a service integration. Cloudflare Integration should only have access to the repository(ies) that are deployed to Cloudflare Pages.</p>
<h6 id="custom-domains--dns-pains">Custom Domains &amp; DNS Pains<a class="anchorjs-link" href="#custom-domains--dns-pains"></a></h6><p>Github &amp; Cloudflare pages host websites, but they do so using their own domains. Github uses a <code>.github.io</code> extension and Cloudflare uses a <code>.pages.dev extension</code>. We would obviously prefer our own custom domain, so what we have to do is change the DNS records for our site to point to the content deployed by our hosting platform. In Cloudflare, here is what my DNS settings look like for my website.</p>
<p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/cloudflare-dns_hu6c6da6c3dbacfafc6f63384e3029c720_26115_1267x149_resize_q75_h2_box_3.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/cloudflare-dns.6a8e3d6ae1d71dc2b26b0f6d206a0dd3.png"
    alt="image"
    loading="lazy"
    height="149"
    width="1267"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">Middle entry unrelated &amp; redacted.</figcaption>
    </figure></p>
<p>Our <code>CNAME</code> allow us to load the content of the <code>pages.dev</code>, but access it via our custom domain name. My domain name servers are with Cloudflare, which makes the setup very easy. If moving from Github Pages, make sure to remove the custom domain from the Github Pages site &amp; to transfer name servers. We also redirect the <code>www</code> subdomain since it is still sometimes used, and we just want it to redirect to the same content anyways. We can also see that on our Workers/Pages configuration we have setup our custom domains.</p>
<p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/custom-domains_hu28d22fff799dfb28df8af362a6459328_28540_650x321_resize_q75_h2_box_3.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/custom-domains.6e7d070ff607343fdd3927b06b1f9a48.png"
    alt="image"
    loading="lazy"
    height="321"
    width="650"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">Cloudflare &#39;Workers &amp; Pages&#39; tab.</figcaption>
    </figure></p>
<h6 id="staging-environment">Staging Environment<a class="anchorjs-link" href="#staging-environment"></a></h6><p>Now, we have automatic deployments from our main branch, as well as automatic preview branches! We could be done, but I prefer to just have one staging site, at least for now. In future, I will cover using Cloudflare Zero Trust to password protect all staging sites.</p>
<p>On the &lsquo;Workers &amp; Pages&rsquo; tab of Cloudflare, we can click on the details for our site, then head to &ldquo;Settings&rdquo;, then &ldquo;Builds &amp; deployments&rdquo;. We can leave the top production branch alone, but here is my configuration for the preview deployments:</p>
<p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/staging-site_huddb81c2c6f849b185452a160c61ea4c7_49911_847x751_resize_q75_h2_box_3.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/staging-site.432e4832f5acaa534be06a23714a48af.png"
    alt="image"
    loading="lazy"
    height="751"
    width="847"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">Now only commits pushed/merged to development will have preview pages.</figcaption>
    </figure></p>
<p>So now we only publish a live version of our <code>development</code> branch at <code>https://development.repoName.pages.dev</code>!</p>
<h4 id="two-environments-both-alike-in-config">Two Environments, both alike in config<a class="anchorjs-link" href="#two-environments-both-alike-in-config"></a></h4><p>Having two environments now means we need to have configurations for each. Hugo allows multiple configs, and we only need two:</p>
<ul>
<li><code>config/_default/config.toml</code> for development &amp; staging
<ul>
<li>This config has 90% of the site settings, since we need most of them for the site to build correctly.</li>
<li>My staging website has the title set as &ldquo;ivy (development)&rdquo; &amp; the <code>pages.dev</code> baseURL.</li>
</ul>
</li>
<li><code>config/production/config.toml</code> for production
<ul>
<li>This config only holds a few settings that we only want on our live site, such as application keys for analytics/comments/etc.</li>
<li>My production website has the title &ldquo;ivy (likethevine)&rdquo;, as well as giscus (comments) settings, and my custom domain baseURL.</li>
</ul>
</li>
</ul>
<p>Hugo uses the <code>_default</code> config, but it can apply the <code>production</code> config if passed a flag during deployment. Luckily, since Cloudflare Pages supports Hugo out of the box, we simply need to set a few environment variables in the GUI. Back at the settings for our website, we can define the following flags. These will be passed to the <code>hugo build</code> command when we deploy:</p>
<p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/environment-variables_huccc976df2624bb3403476075643b20e3_40068_1177x404_resize_q75_h2_box_3.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/environment-variables.86025e1f4dbd53d091c4e201a1e5645f.png"
    alt="image"
    loading="lazy"
    height="404"
    width="1177"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">Simple configuration, huh.</figcaption>
    </figure></p>
<p><strong>Note</strong>: Environment variables are also useful for securing data that absolutely should not be in the main git repository, such as SSH/application keys.</p>
<h4 id="iii-prevent-disaster-with-automatic-checks">iii. Prevent Disaster with Automatic Checks<a class="anchorjs-link" href="#iii-prevent-disaster-with-automatic-checks"></a></h4><p>Now that we have our SVM and our automatic deployments, lets talk workflow. Github (and other SVMs) provide many automated checks and systems to prevent the dreaded &ldquo;new dev destroys prod&rdquo; disaster. <a href="https://docs.github.com/en/repositories/configuring-branches-and-merges-in-your-repository/managing-protected-branches/managing-a-branch-protection-rule" target="_blank">Branch protection rules</a> are super simple and useful. Common rules include preventing direct pushes to <code>main</code>, requiring pull requests to be approved by others before being merged, and tons of more complex versions.</p>
<p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/pull-request-check_hu3be658b6759b06d1e0ba1eafc55b1d8a_127083_1294x811_resize_q75_h2_box_3.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/pull-request-check.d0a39d152182fe90cb2f6941cdc3c932.png"
    alt="image"
    loading="lazy"
    height="811"
    width="1294"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">Additionally, integrations (such as the Cloudflare Pages one), will actually show if the staging deployment works on the PR, providing even more feedback and warning if something is awry.</figcaption>
    </figure></p>
<p>












  
  
    
    
    
    
    
    
    
    
  
    <figure class="figure ">
      <picture>
    <source srcset="/projects/site/images/branch-protection_hu3ce8a5cab58c9a146c0a135b27f30443_47670_795x363_resize_q75_h2_box_3.webp" type="image/webp" />
  <img
    class="figure-img img-fluid"
    src="/projects/site/images/branch-protection.8519c49f1c8d91533b5e617ef0f07e22.png"
    alt="image"
    loading="lazy"
    height="363"
    width="795"
    
    
    
     />
</picture>

      <figcaption class="figure-caption">And this branch protection rule option will not allow deployments with failed Cloudflare statuses on their Pull Requests.</figcaption>
    </figure></p>
<p>Here are the basic steps to working within a system like this:</p>
<ol>
<li>Create a <code>featureName</code> branch off of <code>development</code>.</li>
<li>Add a feature/bugfix/etc, modifying as few files as possible.</li>
<li>Add files &amp; commit at major checkpoints, leaving short but useful commit messages.</li>
<li>When a feature is ready for evaluation, push to the <code>featureName</code> branch, then open a pull request to merge <code>featureName</code> into <code>development</code>.</li>
<li>Have the pull request approved &amp; merged by supervisor (or double check manually).</li>
<li>Test the staging site.</li>
<li>Deploy to production via pull request from <code>development</code> into <code>main</code>.</li>
</ol>
<pre class="mermaid">
gitGraph
    commit
    branch develop
    checkout develop
    commit
    branch add-feature
    checkout add-feature
    commit
    checkout develop
    merge add-feature
    checkout main
    merge develop
    checkout develop
</pre>

<h2 id="reap-the-benefits">Reap the Benefits<a class="anchorjs-link" href="#reap-the-benefits"></a></h2><p>So with all of that work, what do we really get? Time to revisit those goals:</p>
<ul>
<li>Source Version Mangement
<ul>
<li><strong>Rule 1</strong>: software changes need to be easily assigned, tracked, and checked
<ul>
<li>stored in github following git-flow</li>
</ul>
</li>
<li><strong>Rule 2</strong>: environment variables need to be stored safely (important enough to state again)
<ul>
<li>dual config files locally as well as environment variables stored in our host</li>
</ul>
</li>
</ul>
</li>
<li>Deployments
<ul>
<li><strong>Rule 1</strong>: deploying new versions should be automated via CI/CD and require no human intervention
<ul>
<li>most deployments require a simple approve &amp; merge of a pull request (via a Web UI)</li>
</ul>
</li>
<li><strong>Rule 2</strong>: staging site to test versions before production deployment
<ul>
<li>staging site automatically deployed from <code>development</code></li>
</ul>
</li>
</ul>
</li>
<li>Onboarding
<ul>
<li><strong>Rule 1</strong>: new devs need to be able to download and deploy system within a day<sup id="fnref1:2"><a href="#fn:2" class="footnote-ref" role="doc-noteref">2</a></sup>
<ul>
<li>with a proper SVM, git flow, and environment configurations, onboarding will be a breeze</li>
</ul>
</li>
<li><strong>Rule 2</strong>: new devs should not be able to break production
<ul>
<li>branch protection rules, pull requests, and automated integrations mitigate or prevent most accidental destruction</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>The initial setup takes time, for certain, but now we will gain efficiency almost every single day from now on! Your managers, coworkers, and <strong>your future self</strong> will thank you, trust me.</p>
<h5 id="footnotes">Footnotes<a class="anchorjs-link" href="#footnotes"></a></h5><div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://www.ibm.com/topics/devops" target="_blank">https://www.ibm.com/topics/devops</a>&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:2">
<p>Slight caveat here, some systems require lots of permissions/database access, which could increase this time, but the repository setup should be quick.&#160;<a href="#fnref:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a>&#160;<a href="#fnref1:2" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:3">
<p>If you are migrating github -&gt; Cloudflare with a custom domain, I recommend changing the domain registrar to Cloudflare for easier integration. Additionally, if your repo followed the <code>username.github.io</code> nomenclature, rename it before you deploy to Cloudflare, otherwise your staging site will end up as development.<username>-github-io.pages.dev.&#160;<a href="#fnref:3" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
<li id="fn:4">
<p>Stay tuned, I am working on an article about using Cloudflare Zero Trust to safely access self hosted services without network configuration.&#160;<a href="#fnref:4" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>


        <hr style="visibility: hidden;" />
        <ul class="pager">
          
          <li class="previous">
            <a href="/projects/homelab-design-v1/" data-toggle="tooltip" data-placement="top" title="Laptop Homelab in 5 Commands">
              Previous<br>
              <span>Laptop Homelab in 5 Commands</span>
            </a>
          </li>
          
          
          <li class="next">
            <a href="/projects/homelab-backups/" data-toggle="tooltip" data-placement="top" title="NAS Backups and the Dark USB Arts">
              Next<br>
              <span>NAS Backups and the Dark USB Arts</span>
            </a>
          </li>
          
        </ul>
        <hr style="visibility: hidden;" />

        
        



<div class="giscus" id="comments"></div>
<script src="https://giscus.app/client.js" 
  data-repo="ivylikethevine/ivylikethevine" 
  data-repo-id="R_kgDOKTpUbw"
  data-category="General"
  data-category-id="DIC_kwDOKTpUb84CZ09b"
  data-mapping="pathname"
  data-strict="0" 
  data-reactions-enabled="1" 
  data-emit-metadata="0" 
  data-input-position="top"
  data-theme="light"
  data-lang="en"
  crossorigin="anonymous"
  async>
  </script>




      </div>

      
      
      
      
      <div class="
              col-lg-8 col-lg-offset-2
              col-md-10 col-md-offset-1
              sidebar-container">

        
        
        <section>
  
  
  <hr class="hidden-sm hidden-xs">
  
  <h5>FEATURED TAGS</h5>
  <div class="tags">
    
    <a href="/tags/3d-printing/">3d-printing</a>
    
    <a href="/tags/backups/">backups</a>
    
    <a href="/tags/ci/cd/">CI/CD</a>
    
    <a href="/tags/cloudflare/">Cloudflare</a>
    
    <a href="/tags/cognitive-science/">cognitive science</a>
    
    <a href="/tags/data-redundancy/">data redundancy</a>
    
    <a href="/tags/dev-ops/">dev ops</a>
    
    <a href="/tags/devops/">devops</a>
    
    <a href="/tags/dns/">DNS</a>
    
    <a href="/tags/docker/">docker</a>
    
    <a href="/tags/full-stack/">full stack</a>
    
    <a href="/tags/github/">github</a>
    
    <a href="/tags/homelab/">homelab</a>
    
    <a href="/tags/hugo/">hugo</a>
    
    <a href="/tags/linux/">linux</a>
    
    <a href="/tags/nas/">nas</a>
    
    <a href="/tags/networking/">networking</a>
    
    <a href="/tags/storage/">storage</a>
    
    <a href="/tags/typescript/">typescript</a>
    
    <a href="/tags/usb/">usb</a>
    
  </div>
</section>

        
        

      </div>
    </div>
  </div>
</article>



  
<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
        
        <ul class="list-inline text-center">

<li>
  <a href="https://github.com/ivylikethevine" target="_blank">
    <span class="fa-stack fa-lg">
      <i class="fa fa-circle fa-stack-2x"></i>
      <i class="fab fa-github fa-stack-1x fa-inverse"></i>
    </span>
  </a>
</li>

<li>
  <a href="https://linkedin.com/in/ivylikethevine" target="_blank">
    <span class="fa-stack fa-lg">
      <i class="fa fa-circle fa-stack-2x"></i>
      <i class="fab fa-linkedin fa-stack-1x fa-inverse"></i>
    </span>
  </a>
</li>

<li>
  <a href="https://medium.com/@ivylikethevine" target="_blank">
    <span class="fa-stack fa-lg">
      <i class="fa fa-circle fa-stack-2x"></i>
      <i class="fab fa-medium fa-stack-1x fa-inverse"></i>
    </span>
  </a>
</li></ul>

        <p class="copyright text-muted">
          Copyright &copy; ivy (likethevine) 2023  
          <br>
          Powered by <a href="https://gohugo.io">Hugo</a>
        </p>
      </div>
    </div>
  </div>
</footer>

<script src=/js/jquery.min.js></script>
<script src=/js/bootstrap.min.js crossorigin="anonymous"></script>



<script src="/js/hux-blog.min.c4ea77041cd3edbfc8b2622cd887a9a5d8760a4162d14489e36d2a3fa4c90172.js"></script>


<script src=/js/simple-jekyll-search.min.js></script>


<script src="/js/search.min.53bce5da475b4d362500e5ce5dddfa22e20e1b9018777411d2020b4b839c9310.js"></script>













<script src="/zoomjs/zoom.min.js"></script>

</body>

</html>